from decimal import Decimal

data = """
2025-01-01    11,04    11,07
2025-01-02    10,63    11,08
2025-01-03    11,04    11,07
2025-01-04    11,04    11,07
2025-01-05    11,04    11,06
2025-01-06    11,03    11,05
2025-01-07    11,13    11,09
2025-01-08    11,14    11,45
2025-01-09    10,76    11,24
2025-01-10    11,11    11,14
2025-01-11    11,11    11,13
2025-01-12    11,11    11,14
2025-01-13    11,16    11,2
2025-01-14    11,16    11,21
2025-01-15    11,17    11,23
2025-01-16    11,22    11,28
2025-01-17    11,24    11,29
2025-01-18    11,21    11,27
2025-01-19    11,31    11,35
2025-01-20    11,32    11,29
2025-01-21    11,39    11,35
2025-01-22    11,29    11,24
2025-01-23    11,34    11,3
2025-01-24    11,3     11,28
2025-01-25    11,31    11,27
2025-01-26    11,31    11,27
2025-01-27    11,3     11,27
2025-01-28    11,29    11,26
2025-01-29    11,28    11,26
2025-01-30    11,25    11,21
2025-01-31    11,24    11,21
2025-02-01    11,17    11,13
2025-02-02    11,18    11,17
2025-02-03    11,18    11,14
2025-02-04    11,18    11,14
2025-02-05    11,2     11,17
2025-02-06    11,2     11,17
2025-02-07    11,2     11,16
2025-02-08    11,18    11,14
2025-02-09    11,19    11,16
2025-02-10    11,19    11,15
2025-02-11    11,19    11,16
2025-02-12    11,21    11,19
2025-02-13    11,24    11,2
2025-02-14    11,2     11,16
2025-02-15    11,2     11,16
2025-02-16    11,2     11,17
2025-02-17    11,2     11,17
2025-02-18    11,22    11,19
2025-02-19    11,23    11,21
2025-02-20    11,27    11,24
2025-02-21    11,3     11,27
2025-02-22    11,25    11,22
2025-02-23    11,26    11,23
2025-02-24    11,26    11,23
2025-02-25    11,31    11,29
2025-02-26    11,32    11,31
2025-02-27    11,37    11,33
2025-02-28    11,36    11,32
2025-03-01    11,33    11,3
2025-03-02    11,31    11,28
2025-03-03    11,28    11,25
2025-03-04    11,28    11,25
2025-03-05    11,28    11,26
2025-03-06    11,3     11,26
2025-03-07    11,28    11,26
2025-03-08    11,27    11,23
2025-03-09    11,27    11,23
2025-03-10    11,34    11,29
2025-03-11    11,01    11,56
2025-03-12    11,5     11,96
2025-03-13    12,2     12,16
2025-03-14    11,82    11,8
2025-03-15    11,72    11,75
2025-03-16    11,79    11,76
2025-03-17    11,79    11,77
2025-03-18    11,85    11,9
2025-03-19    11,93    11,96
2025-03-20    12       12,01
2025-03-21    12,04    12,05
2025-03-22    12       11,97
2025-03-23    12,03    12
2025-03-24    12,05    12,01
2025-03-25    12,16    12,12
2025-03-26    12,34    12,3
2025-03-27    12,41    12,36
2025-03-28    12,4     12,38
2025-03-29    12,39    12,35
2025-03-30    12,39    12,35
2025-03-31    12,41    12,38
2025-04-01    12,45    12,44
2025-04-02    12,65    12,62
2025-04-03    12,84    12,81
2025-04-04    12,87    12,85
2025-04-05    12,86    12,83
2025-04-06    12,87    12,84
2025-04-07    12,94    12,91
2025-04-08    13,09    13,05
2025-04-09    13,38    13,33
2025-04-10    13,44    13,5
2025-04-11    13,44    13,45
2025-04-12    13,28    13,29
2025-04-13    13,42    13,38
2025-04-14    13,43    13,39
2025-04-15    13,44    13,41
2025-04-16    13,46    13,42
2025-04-17    13,55    13,52
2025-04-18    13,51    13,47
2025-04-19    13,46    13,43
2025-04-20    13,52    13,5
2025-04-21    13,5     13,49
2025-04-22    13,53    13,52
2025-04-23    13,63    13,57
2025-04-24    14,36    13,97
2025-04-25    14,13    14,1
2025-04-26    14,23    14,17
2025-04-27    14,49    14,49
2025-04-28    14,73    14,7
2025-04-29    15,21    15,16
2025-04-30    15,23    15,2
2025-05-01    15,27    15,2
2025-05-02    15,22    15,17
2025-05-03    15,17    15,82
2025-05-04    15,2     15,16
2025-05-05    15,19    15,14
2025-05-06    15,25    15,21
2025-05-07    15,29    15,29
2025-05-08    15,47    15,42
2025-05-09    15,45    15,42
2025-05-10    15,46    15,41
2025-05-11    15,45    15,41
2025-05-12    15,59    15,56
2025-05-13    15,97    15,94
2025-05-14    17,09    17,11
2025-05-15    17,74    17,81
2025-05-16    17,76    17,69
2025-05-17    17,44    17,44
2025-05-18    17,79    17,72
2025-05-19    17,54    17,54
2025-05-20    17,45    17,47
2025-05-21    17,46    17,48
2025-05-22    17,45    17,46
2025-05-23    17,19    17,2
2025-05-24    16,55    17,02
2025-05-25    16,49    16,74
2025-05-26    16,37    16,48
2025-05-27    16,31    16,43
2025-05-28    16,4     16,53
2025-05-29    16,57    16,66
2025-05-30    16,43    16,44
2025-05-31    16,37    16,33
2025-06-01    16,39    16,34
2025-06-02    16,34    16,3
2025-06-03    16,34    16,3
2025-06-04    16,35    16,34
2025-06-05    16,37    16,34
2025-06-06    16,36    16,32
2025-06-07    16,33    16,29
2025-06-08    16,33    16,28
2025-06-09    16,3     16,25
2025-06-10    16,3     16,27
2025-06-11    16,32    16,29
2025-06-12    16,37    16,33
2025-06-13    16,34    16,3
2025-06-14    16,3     16,26
2025-06-15    16,32    16,29
2025-06-16    16,31    16,27
2025-06-17    16,3     16,27
2025-06-18    16,29    16,26
2025-06-19    16,23    16,18
2025-06-20    16,16    16,11
2025-06-21    15,94    15,93
2025-06-22    16,04    16,01
2025-06-23    16,04    16,03
2025-06-24    16,01    15,99
2025-06-25    16,03    15,99
2025-06-26    16       15,96
2025-06-27    15,91    15,85
2025-06-28    15,19    15,46
2025-06-29    15,56    15,51
2025-06-30    14,91    14,83
2025-07-01    14,26    14,29
2025-07-02    14,87    14,81
2025-07-03    15,2     15,15
2025-07-04    15,2     15,14
2025-07-05    14,98    14,92
2025-07-06    15,06    15,03
2025-07-07    15,06    15,07
2025-07-08    15,07    15,04
2025-07-09    15,07    15,03
2025-07-10    15,01    14,96
2025-07-11    14,8     14,76
2025-07-12    14,69    14,65
2025-07-13    14,72    14,68
2025-07-14    14,7     14,64
2025-07-15    14,67    14,64
2025-07-16    14,56    14,6
2025-07-17    14,6     14,58
2025-07-18    14,39    14,37
2025-07-19    14,32    14,34
2025-07-20    14,38    14,38
2025-07-21    14,19    14,34
2025-07-22    13,95    14
2025-07-23    13,62    13,68
2025-07-24    13,18    13,28
2025-07-25    13,11    13,28
2025-07-26    13,11    13,23
2025-07-27    13,14    13,28
2025-07-28    13,67    13,71
2025-07-29    13,42    13,97
2025-07-30    13,71    14,13
2025-07-31    13,95    14,13
"""

# ------------------ LÓGICA ------------------

valores_sql = []

for line in data.strip().splitlines():
    # separa por espacios/tabulaciones
    parts = line.split()
    if len(parts) < 3:
        continue

    fecha = parts[0].strip()
    compra_str = parts[1].strip()
    venta_str = parts[2].strip()

    # cambiar coma por punto y convertir a Decimal
    compra = Decimal(compra_str.replace(',', '.'))
    venta  = Decimal(venta_str.replace(',', '.'))

    # formato a 8 decimales
    compra_fmt = format(compra, '.8f')
    venta_fmt  = format(venta, '.8f')

    timestamp = f"{fecha} 10:41:53"

    # registro BUY
    valores_sql.append(
        f"('{fecha}','manual',{compra_fmt},'buy','{timestamp}','{timestamp}')"
    )
    # registro SELL
    valores_sql.append(
        f"('{fecha}','manual',{venta_fmt},'sell','{timestamp}','{timestamp}')"
    )

# armar INSERT único
inicio = "INSERT INTO `blue_exchange_rates` (`date`, `source`, `rate`, `type`, `created_at`, `updated_at`) VALUES\n"
cuerpo = ",\n".join(valores_sql) + ";"

sql_final = inicio + cuerpo

print(sql_final)
